<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>FlightlessManacotti: runtime/src/thirdparty/amp/src/c/amp/amp_platform.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#define-members">Defines</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<h1>runtime/src/thirdparty/amp/src/c/amp/amp_platform.h File Reference</h1>  </div>
</div>
<div class="contents">
<code>#include &lt;stddef.h&gt;</code><br/>
<code>#include &lt;<a class="el" href="amp__memory_8h_source.html">amp/amp_memory.h</a>&gt;</code><br/>

<p><a href="amp__platform_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="amp__platform_8h.html#a100ff20b3d686febcccf0e7af0947bb2">AMP_PLATFORM_UNINITIALIZED</a>&nbsp;&nbsp;&nbsp;NULL</td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="amp__platform_8h.html#a7ff657e47d729a5549826b7cc5ab3c8a">amp_platform_create</a> (amp_platform_t *descr, amp_allocator_t allocator)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="amp__platform_8h.html#aa6102d96e67706448523a3f5d1eaadb8">amp_platform_destroy</a> (amp_platform_t *descr, amp_allocator_t allocator)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="amp__platform_8h.html#a8f07067aee5b2c1c9cf4bd495a43c5ef">amp_platform_get_installed_core_count</a> (amp_platform_t descr, size_t *result)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="amp__platform_8h.html#aaa003fc8ad49496489facc09045ada57">amp_platform_get_active_core_count</a> (amp_platform_t descr, size_t *result)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="amp__platform_8h.html#a4cc6be00a6743ce0903c8ed962d53abc">amp_platform_get_installed_hwthread_count</a> (amp_platform_t descr, size_t *result)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="amp__platform_8h.html#a050e8740a5e8f571c0c6aebacd9e9ff4">amp_platform_get_active_hwthread_count</a> (amp_platform_t descr, size_t *result)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="amp__platform_8h.html#abc4b100efd15244d82248ba95831fb39">amp_platform_get_concurrency_level</a> (amp_platform_t descr, size_t *result)</td></tr>
</table>
<hr/><a name="_details"></a><h2> </h2>
<p>Platform detection functions to query the concurrency level of the hardware and operating system combination. Assumes that the hardware is homogeneous and only queries the architecture the software runs on, i.e. doesn't detect the GPU when run on CPU.</p>
<p>TODO:</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000016">Todo:</a></b></dt><dd><p class="startdd">Add detection for the number of packages (CPU dies), cores per package, hw-threads per core. Take non-homoheneous platforms into account. Also detect memory and cache sizes and cache / local storage grouping of hw-threads and cores and detect if the platform is an UMA or NUMA architecture. Add ways to detect if specific infos can be determined or not on the platform in use. TODO: </p>
<p>Decide if to implement the following functions: size_t amp_platform_get_package_type_count(void); size_t amp_platform_get_package_count_for_type(size_t package_type_id); size_t amp_platform_get_core_type_count(size_t package_type_id); size_t amp_platform_get_installed_core_count_for_type(size_t package_type_id, size_t core_type_for_package_type_id); size_t amp_platform_get_installed_hwthread_count(size_t package_type_id, size_t core_type_for_package_type_id); TODO: </p>
<p>Add source file using GetLogicalProcessorInformationEx to query the platform on Windows Vista or later Windows versions. TODO: </p>
<p class="enddd">Check back with Windows platform query documentation to only create a query buffer on platform creation instead of using the stored allocator for each query.</p>
</dd></dl>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="a100ff20b3d686febcccf0e7af0947bb2"></a><!-- doxytag: member="amp_platform.h::AMP_PLATFORM_UNINITIALIZED" ref="a100ff20b3d686febcccf0e7af0947bb2" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AMP_PLATFORM_UNINITIALIZED&nbsp;&nbsp;&nbsp;NULL</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a7ff657e47d729a5549826b7cc5ab3c8a"></a><!-- doxytag: member="amp_platform.h::amp_platform_create" ref="a7ff657e47d729a5549826b7cc5ab3c8a" args="(amp_platform_t *descr, amp_allocator_t allocator)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int amp_platform_create </td>
          <td>(</td>
          <td class="paramtype">amp_platform_t *&nbsp;</td>
          <td class="paramname"> <em>descr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amp_allocator_t&nbsp;</td>
          <td class="paramname"> <em>allocator</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Creates a platform context to enable allocation and deallocation of memory if needed by the platform query functions (necessary for Windows Vista and Windows7 platform detection).</p>
<p>The allocator is used (and probably also stored inside descr) to allocate the memory for descr and eventually to create a temporary buffer needed to query the platforms hardware informations (Windows GetLogicalProcessorInformation needs a dynamic buffer) on each query function call.</p>
<p>On error no memory is leaked.</p>
<p>Call amp_platform_destroy to finalize the platform description.</p>
<p>If the initialization fails the allocator is called to free the already allocated memory which must not result in an error or otherwise behavior is undefined.</p>
<dl class="return"><dt><b>Returns:</b></dt><dd>AMP_SUCCESS on successful creation of a platform description. </dd></dl>

</div>
</div>
<a class="anchor" id="aa6102d96e67706448523a3f5d1eaadb8"></a><!-- doxytag: member="amp_platform.h::amp_platform_destroy" ref="aa6102d96e67706448523a3f5d1eaadb8" args="(amp_platform_t *descr, amp_allocator_t allocator)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int amp_platform_destroy </td>
          <td>(</td>
          <td class="paramtype">amp_platform_t *&nbsp;</td>
          <td class="paramname"> <em>descr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amp_allocator_t&nbsp;</td>
          <td class="paramname"> <em>allocator</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Finalizes descr (invalidates it), frees its memory.</p>
<dl class="return"><dt><b>Returns:</b></dt><dd>AMP_SUCCESS on successful destruction of descr. If allocator is unable to free the memory allocated with the allocator used for the amp_platform_create call an allocator specific error code is returned and the behavior is undefined, e.g. resources might be leaked and descr becomes invalid. </dd></dl>

</div>
</div>
<a class="anchor" id="aaa003fc8ad49496489facc09045ada57"></a><!-- doxytag: member="amp_platform.h::amp_platform_get_active_core_count" ref="aaa003fc8ad49496489facc09045ada57" args="(amp_platform_t descr, size_t *result)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int amp_platform_get_active_core_count </td>
          <td>(</td>
          <td class="paramtype">amp_platform_t&nbsp;</td>
          <td class="paramname"> <em>descr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&nbsp;</td>
          <td class="paramname"> <em>result</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Queries the platform for the number of currently active processor cores.</p>
<p>descr must be valid (created) and not be NULL.</p>
<p>If the platform can be queried for this information the result is stored at the memory location result points to and AMP_SUCCESS is returned by the function. If result is NULL the function return value (see below) indicates if the information can be queried.</p>
<p>If the information can not be queried descr isn't touched or changed.</p>
<dl class="return"><dt><b>Returns:</b></dt><dd>AMP_SUCCESS if the information can be queried or AMP_UNSUPPORTED if the information can not be queried. AMP_ERROR might be returned on error based on the used backend. </dd></dl>

</div>
</div>
<a class="anchor" id="a050e8740a5e8f571c0c6aebacd9e9ff4"></a><!-- doxytag: member="amp_platform.h::amp_platform_get_active_hwthread_count" ref="a050e8740a5e8f571c0c6aebacd9e9ff4" args="(amp_platform_t descr, size_t *result)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int amp_platform_get_active_hwthread_count </td>
          <td>(</td>
          <td class="paramtype">amp_platform_t&nbsp;</td>
          <td class="paramname"> <em>descr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&nbsp;</td>
          <td class="paramname"> <em>result</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Queries the platform for the number of currently active hardware threads</p>
<ul>
<li>if the platform support simultaneous multithreading (and supports querying this information) then the number returned might be greater than the one returned by amp_platform_get_active_core_count.</li>
</ul>
<p>descr must be valid (created) and not be NULL.</p>
<p>If the platform can be queried for this information the result is stored at the memory location result points to and AMP_SUCCESS is returned by the function. If result is NULL the function return value (see below) indicates if the information can be queried.</p>
<p>If the information can not be queried descr isn't touched or changed.</p>
<dl class="return"><dt><b>Returns:</b></dt><dd>AMP_SUCCESS if the information can be queried or AMP_UNSUPPORTED if the information can not be queried. AMP_ERROR might be returned on error based on the used backend. </dd></dl>

</div>
</div>
<a class="anchor" id="abc4b100efd15244d82248ba95831fb39"></a><!-- doxytag: member="amp_platform.h::amp_platform_get_concurrency_level" ref="abc4b100efd15244d82248ba95831fb39" args="(amp_platform_t descr, size_t *result)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int amp_platform_get_concurrency_level </td>
          <td>(</td>
          <td class="paramtype">amp_platform_t&nbsp;</td>
          <td class="paramname"> <em>descr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&nbsp;</td>
          <td class="paramname"> <em>result</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Queries the platform for the maximum concurrency level supported, that might be the count of installed hardware-threads or cores, or the number of active hardware-threads or cores based on what is supported by the platform's backend.</p>
<p>If the query is not supported AMP_UNSUPPORTED is returned and result is unchanged and untouched.</p>
<p>If result is NULL the function call can be used to determine if the query is supported or not.</p>
<dl class="return"><dt><b>Returns:</b></dt><dd>AMP_SUCCESS on successful concurrency level query. AMP_UNSUPPORTED if the platform does not support this query. </dd></dl>

</div>
</div>
<a class="anchor" id="a8f07067aee5b2c1c9cf4bd495a43c5ef"></a><!-- doxytag: member="amp_platform.h::amp_platform_get_installed_core_count" ref="a8f07067aee5b2c1c9cf4bd495a43c5ef" args="(amp_platform_t descr, size_t *result)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int amp_platform_get_installed_core_count </td>
          <td>(</td>
          <td class="paramtype">amp_platform_t&nbsp;</td>
          <td class="paramname"> <em>descr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&nbsp;</td>
          <td class="paramname"> <em>result</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Queries the platform for the number of processor cores (active or not).</p>
<p>descr must be valid (created) and not be NULL.</p>
<p>If the platform can be queried for this information the result is stored at the memory location result points to and AMP_SUCCESS is returned by the function. If result is NULL the function return value (see below) indicates if the information can be queried.</p>
<p>If the information can not be queried descr isn't touched or changed.</p>
<dl class="return"><dt><b>Returns:</b></dt><dd>AMP_SUCCESS if the information can be queried or AMP_UNSUPPORTED if the information can not be queried. AMP_ERROR might be returned on error based on the used backend. </dd></dl>

</div>
</div>
<a class="anchor" id="a4cc6be00a6743ce0903c8ed962d53abc"></a><!-- doxytag: member="amp_platform.h::amp_platform_get_installed_hwthread_count" ref="a4cc6be00a6743ce0903c8ed962d53abc" args="(amp_platform_t descr, size_t *result)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int amp_platform_get_installed_hwthread_count </td>
          <td>(</td>
          <td class="paramtype">amp_platform_t&nbsp;</td>
          <td class="paramname"> <em>descr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&nbsp;</td>
          <td class="paramname"> <em>result</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Queries the platform for the number of hardware threads - if the platform support simultaneous multithreading (and supports querying this information) then the number returned might be greater than the one returned by amp_platform_get_installed_core_count.</p>
<p>descr must be valid (created) and not be NULL.</p>
<p>If the platform can be queried for this information the result is stored at the memory location result points to and AMP_SUCCESS is returned by the function. If result is NULL the function return value (see below) indicates if the information can be queried.</p>
<p>If the information can not be queried descr isn't touched or changed.</p>
<dl class="return"><dt><b>Returns:</b></dt><dd>AMP_SUCCESS if the information can be queried or AMP_UNSUPPORTED if the information can not be queried. AMP_ERROR might be returned on error based on the used backend. </dd></dl>

</div>
</div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Wed Oct 12 2011 15:00:35 for FlightlessManacotti by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
