<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>FlightlessManacotti: README.markdown</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">FlightlessManacotti
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title"><a class="el" href="_r_e_a_d_m_e_8markdown.html">README.markdown</a> </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"> 
<h1>Flightless Manicotti</h1>

<p>A free-time project.</p>

<h2>Untested Code</h2>

<p>This code is untested. Most of it has been coded on a couch. Some of it may be kind of stupid, too.</p>

<p>I've found a bunch of bugs, bad assumptions, and generally-dumb ideas in my code. There's no reason why someone else won't find more that I've missed.</p>

<h2>License</h2>

<p>Unless otherwise stated in a file, this project is licensed under the <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache License, Version 2.0</a>, the text of which can be found at the previous link, or in the LICENSE file.</p>

<p>Each code file has its license located at the top of the file. If any file is missing its license, it should be considered to be licensed under the <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache License, Version 2.0</a>. </p>

<h2>Platform Compatibility</h2>

<p>FlightlessManicotti is intended for use across many architectures and operating systems. While all attempts will be made to keep compatibility with the widest range of platforms, the project does have priorities.</p>

<h3>Architecture Priorities</h3>

<ul>
<li>x86/x64</li>
<li>ARM</li>
<li>PPC</li>
</ul>

<h3>Operating System Priorities</h3>

<ul>
<li>MacOS</li>
<li>iOS</li>
<li>Android</li>
<li>Windows</li>
<li>Linux</li>
</ul>

<h1>Dependencies</h1>

<p>All dependencies are included within the repository, and are built as part of the standard build process.</p>

<h2>Libraries</h2>

<ul>
<li><a href="http://github.com/bjoernknafla/amp">amp</a> revision <a href="http://github.com/bjoernknafla/amp/tree/a84380c4e2a6d66283bc7c33d70e6fe8f0e1e71f">a84380c</a></li>
<li><a href="http://www.nedprod.com/programs/portable/nedmalloc/">nedmalloc</a> revision <a href="http://github.com/ned14/nedmalloc/tree/3f80a00da9d9198788ad8fca0b31f8fcb665a624">3f80a00</a></li>
<li><a href="http://github.com/ned14/uthash">uthash</a> revision <a href="http://github.com/ned14/uthash/tree/22bf8c92ba46b3071f782e932b568597d7a9b374">22bf8c9</a></li>
<li><a href="http://luajit.org/">LuaJIT</a> version <a href="http://luajit.org/download/LuaJIT-2.0.0-beta10.tar.gz">2.0.0-beta10</a></li>
<li><a href="http://codesuppository.blogspot.com/2009/09/free-open-source-micro-allocator-in-c.html">MicroAllocator</a> version <a href="http://code.google.com/p/microallocator/source/browse/?r=5">5</a></li>
<li><a href="http://openctm.sourceforge.net/">OpenCTM</a> version <a href="https://sourceforge.net/projects/openctm/files/OpenCTM-1.0.3/OpenCTM-1.0.3-src.tar.bz2/download">1.0.3</a></li>
<li><a href="http://freeimage.sourceforge.net/">FreeImage</a> version <a href="http://downloads.sourceforge.net/freeimage/FreeImage3153.zip">3.15.3</a></li>
</ul>

<h1>Philosophy</h1>

<p>At its core, FlightlessManicotti is an implementation of several ideas and architectural-philosophies that my colleagues, and I have talked about over beer for several years. </p>

<h2>Goals</h2>

<h3>Runtime</h3>

<ul>
<li>Target many-core platforms.</li>
<li>Be able to run in a single thread.</li>
<li>Trust the programmer.</li>
<li>Minimize memory [re]allocation.</li>
<li>Be nice to the data cache.</li>
<li>Use SIMD-friendly data-structures.</li>
</ul>

<h3>Scripting</h3>

<ul>
<li>Communicate with other sub-systems asynchronously.</li>
<li>Empower the scripter.</li>
</ul>

<h2>Runtime</h2>

<p><em>Keep it small. Keep it simple. Keep it fast.</em></p>

<p>The runtime is a shared library, but can be compiled as a static library if necessary for the target-platform. The runtime is fast, minimal, and focused on real-time tasks. </p>

<p>The runtime appears to be 'missing' several features which you would expect.</p>

<ul>
<li>Resource loading.</li>
<li>String management.</li>
<li>File format conversion.</li>
</ul>

<p>This is intentional. These are not real-time tasks and should, instead, be performed in script.</p>

<h2>Scripting</h2>

<p><em>Scripting will never be fast enough.</em></p>

<p>That may not be true, but it is the philosophy for scripting in FlightlessManicotti. The runtime is coded with the assumption that scripting will never be fast enough for real time, so lets not try to do it in real time. This makes it possible to handle scripting tasks in a thread, if the platform supports it, or allows it to be processed synchronously.</p>

<p>The overwhelming majority of communication to-and-from script will be done via queues using a producer-consumer relationship. Immediate, synchronous handling of events is possible, however it is discouraged unless there is no other way of accomplishing the task.</p>

<p>The runtime is not overly concerned about the language used to implement the event handlers. This is intentional, because while FlightlessManicotti uses Lua as a scripting language, by default, there is no reason why a different mechanism for handling events should be prohibited.</p>

<h2>Memory Allocation</h2>

<p><em>Don't.</em></p>

<p>The philosophy for memory allocation in FlightlessManicotti is: don't. </p>

<p>Unfortunately one can only go so far using this methodology, and so several allocators exist. Each allocation function has a purpose and the allocators are function-pointers which can be reassigned by the user. All allocation from the runtime must use these allocators.</p>

<p><strong>Todo</strong>: Ensure SWIG, and all libs use these functions.</p>

<h3>kl<em>heap</em>alloc</h3>

<p>The <code>kl_heap_alloc</code> and <code>kl_heap_free</code> functions allocate and free memory aligned on a 16-byte boundary.</p>

<p>These function pointers default to results from the <a href="http://www.nedprod.com/programs/portable/nedmalloc/">nedmalloc</a> library.</p>

<h3>kl<em>heap</em>aligned_alloc</h3>

<p>The <code>kl_heap_aligned_alloc</code> and <code>kl_heap_aligned_free</code> functions allocate and free memory which is aligned to a boundary other than 16-bytes. <code>kl_heap_aligned_alloc</code> will assert if an alignment of 16-bytes is requested, as you should be using <code>kl_heap_alloc</code> instead.</p>

<p>These function pointers default to a function which manually aligns results from the <a href="http://www.nedprod.com/programs/portable/nedmalloc/">nedmalloc</a> library.</p>

<h3>kl<em>micro</em>alloc</h3>

<p>The <code>kl_micro_alloc</code> and <code>kl_micro_free</code> functions allocate and free memory which is 256-bytes or smaller. Any allocation greater than 256-bytes will cause an assertion.</p>

<p>These function pointers default to results from the <a href="http://codesuppository.blogspot.com/2009/09/free-open-source-micro-allocator-in-c.html">MicroAllocator</a> library.</p>

<h1>Tools</h1>

<p>Tools used to build FlightlessManicotti.</p>

<h2>SCons</h2>

<p>Currently FlightlessManicotti uses <a href="http://www.scons.org/">SCons</a> to do the build. </p>

<h3>Why SCons?</h3>

<ul>
<li>It works pretty well.</li>
<li>Integrates easily with SWIG.</li>
<li>I dislike other build systems more than SCons.</li>
</ul>

<h2>SWIG</h2>

<p>FlightlessManicotti uses <a href="http://www.swig.org/">SWIG</a> to wrap structures and functions for use in Lua.</p>

<h2>LLVM/Clang</h2>

<p>FlightlessManicotti will use <a href="http://llvm.org/">LLVM</a> and <a href="http://clang.llvm.org/">Clang</a> to compile in order to perform static analysis, and link-time code generation. </p>

<p>Currently Clang can be used to compile by uncommenting a line in the top-level <code>SConscript</code> file, but no static analysis has been attempted yet.</p>

<h2>Doxygen</h2>

<p>FlightlessManicotti uses <a href="http://www.doxygen.org/">Doxygen</a> to generate documentation.</p>

<h3>lua2dox</h3>

<p>FlightlessManicotti includes a slightly-modified version of the <a href="http://github.com/alecchen/doxygen-lua">doxygen-lua</a> project. The modifications are based on revision <a href="http://github.com/alecchen/doxygen-lua/tree/2c33a4a9cd27a8d934af51fd798c19065316762e">2c33a4a</a>.</p>

<p>This is included with FlightlessManicotti and is located at <code>tools/doxygen-lua</code></p>

<h1>Languages</h1>

<h2>C</h2>

<p>The use of C for the runtime is as much a philosophical choice as it is practical. The runtime is intended to be fast, portable, and minimalistic.</p>

<p>If you are implementing a feature in the runtime, and saying to yourself, "Gosh, self, I wish I was using a higher-level language," than you should re-consider implementing the feature in script. For example: The runtime does not do file parsing. Instead it provides functions for allocating, and filling the data-structures it requires. File parsing is a non-realtime task, and as such it is not performed by the runtime.</p>

<h3>Why C?</h3>

<ul>
<li>Portable.</li>
<li>Fast.</li>
<li>Just about everything can bind to it. </li>
<li>Doesn't lend itself to over-engineering.</li>
</ul>

<h3>Code Convention</h3>

<h4>Indentation and Whitespace</h4>

<ul>
<li>Be reasonable about line length -- try and stay under 80-ish.</li>
<li>Three shall be the number of the spaces used to indent, and the number of the spaces used to indent shall be three. Tabs are right out.</li>
<li>There will be no space between a function-name, and the opening parenthesis.</li>
<li>Curley-brackets will begin on the line following statement, unless the entire statement can fit on a single line.</li>
<li>Blocks of code following case and default statements inside a switch statement should either be inline, or begin a new curley-bracket block, with the break inside the scope block.</li>
</ul>

<h4>Comments</h4>

<p>Comments must use C style comments <code>/* ... */</code></p>

<h5>Doxygen tags</h5>

<p>All Doxygen tags should use the <code>@</code> character to denote a tag, for example <code>@tag</code> </p>

<h5>Inline documentation.</h5>

<pre><code>/**&lt; Inline doccumentation will use this notation. */
</code></pre>

<h5>Documentation blocks.</h5>

<pre><code>/**
 * Autobrief is a single line that ends with a peroid.
 *
 * Detailed description may be many lines, but in between
 * section there should be a blank line.
 *
 * @note Note blocks come after details.
 *
 * @attention Attention blocks come after note blocks.
 *            If you need more than one line for any tag,
 *            it should be indented past that tag.
 *
 * @param name Parameters should be doccumented as such, and if
 *        they require multiple lines, only indent past the 'param'. 
 * @return Return value should be specified in the same section as 
 *         the parameters.
 */
</code></pre>

<h4>Types</h4>

<p>Use standard types unless not possible. This is a short table of types and the header needed to use them.</p>

<table>
   <tr>
    <td>#include</td>
    <td>To get types...</td>
   </tr>
   <tr>
     <td>&lt;<a href="http://en.wikipedia.org/wiki/Stdint.h">stdint.h</a>&gt;</td>
      <td>`int8_t`, `uint8_t`, `int16_t`, `uint16_t`, `int32_t`, `uint32_t`, `int64_t`, `uint64_t`,
          `intptr_t`, `uintptr_t`, and more...</td>
   </tr>
   <tr>
      <td>&lt;<a href="http://en.wikipedia.org/wiki/Stddef.h">stddef.h</a>&gt;</td>
      <td>`size_t`, `wchar_t`, `ptrdiff_t`</td>
   </tr>
</table>

<p>If a header is not available on a given platform/compiler, than a header will be provided for that platform/compiler to allow for easy use.</p>

<h4>Memory usage</h4>

<ul>
<li>You will align your memory.</li>
<li>You will use restrict (this is defined to KL_RESTRICT for portability).</li>
<li><a href="http://gamesfromwithin.com/the-const-nazi">You will use const</a>.</li>
</ul>

<h4>Naming</h4>

<ul>
<li>Prefix all exposed symbol names with 'kl', and an underscore between 'kl' and the symbol name. <code>kl_foo()</code></li>
<li>Postfix all exposed types with '_t'. <code>kl_script_context_t</code></li>
</ul>

<h2>Lua</h2>

<p>The scripting language for FlightlessManicotti is <a href="http://www.lua.org/">Lua</a>, using <a href="http://luajit.org/">LuaJIT</a>.</p>

<h3>Why Lua?</h3>

<ul>
<li>Small.</li>
<li>Written in C.</li>
<li>Portable.</li>
<li>Performs well on embedded devices.</li>
<li>Has compatible licensing.</li>
<li>Powerful.</li>
</ul>

<h3>Code Convention</h3>

<p>I haven't used Lua enough yet to put together a code convention.</p>

<h4>Indentation and Whitespace</h4>

<ul>
<li>Be reasonable about line length -- try and stay under 80-ish.</li>
<li>Three shall be the number of the spaces used to indent, and the number of the spaces used to indent shall be three. Tabs are right out.</li>
</ul>

<h4>Doxygen Comment Style</h4>

<p>Doxygen support for Lua is achieved using <a href="http://github.com/alecchen/doxygen-lua">lua2dox</a></p>

<p>Doxygen comments will use this notation <code>--!</code> </p>

<h5>Doxygen tags</h5>

<p>All Doxygen tags should use the <code>@</code> character to denote a tag, for example <code>@tag</code></p>

<h1>Credits</h1>

<h2>Authors</h2>

<ul>
<li><a href="http://github.com/ZeroStride">Pat Wilson</a></li>
</ul>

<h2>Special Thanks</h2>

<ul>
<li><a href="http://github.com/xgalaxy">Robert Blanchet</a></li>
<li>Clark Fagot</li>
<li><a href="http://github.com/nardo">Mark Frohnmayer</a></li>
<li><a href="http://github.com/bengarney">Ben Garney</a></li>
<li><a href="http://github.com/asmaloney">Andy Maloney</a></li>
<li><a href="http://github.com/bzztbomb">Brian Richardson</a></li>
<li><a href="http://github.com/alexsc">Alex Scarborough</a></li>
<li>John Quigley</li>
</ul>

 */ </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Jun 8 2012 12:20:52 for FlightlessManacotti by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.1
</small></address>
</body>
</html>
